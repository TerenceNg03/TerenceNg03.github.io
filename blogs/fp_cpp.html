<!DOCTYPE HTML>

<html>
    <head>
        <title>
             Functional Programming in C++
        </title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="../css/common/common.css">
        <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon/favicon-16x16.png">
        <link rel="manifest" href="../favicon/site.webmanifest">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
            
        </script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="../css/blogs.css">
        <link rel="stylesheet" href="../data/blogs/highlight/styles/default.min.css">
        <script src="../data/blogs/highlight/highlight.min.js">
            
        </script>
        <script src="../data/blogs/highlight/languages/haskell.min.js">
            
        </script>
        <script src="../data/blogs/catalog.js" defer="">
            
        </script>
    </head>
    <body>
        <div class="head-title">
            <div class="logo-ani">
                Terence Ng
            </div>
            <div class="cata">
                <span class="head-split">
                    |
                </span>
                <span class="head-part">
                    Blogs
                </span>
            </div>
        </div>
        <div class="navbar-container">
            <script>
                function autoScrollTo(el) {    var top = $("#" + el).offset().top;    $("html, body").animate({ scrollTop: top }, 1000);    }
            </script>
            <div class="navbar">
                <a href="../index.html">
                    Home
                </a>
                <a href="../blogs/index.html">
                    Blogs
                </a>
                <a href="../photos/index.html">
                    Photos
                </a>
                <a href="../poems/index.html">
                    Poems
                </a>
                <a href="../proses/index.html">
                    Proses
                </a>
                <a href="#" onclick="return false;" onmousedown="autoScrollTo(&#39;About&#39;);">
                    About
                </a>
            </div>
        </div>
        <div class="blog-container">
            <h1>Functional Programming in C++</h1>
<h2>What is functional programming?</h2>
<p>Functional programming is a programming paradigm like Object-Oriented Programming(OOP). In functional programming we focus on functions. Functions can be a parameter or return value of another function. See <a href="https://en.wikipedia.org/wiki/Functional_programming">Wikipedia</a> for more information.</p>
<h2>Lambda Expression</h2>
<p>Lambda AKA anonymous function is a special kind of function that does not have a name. It is especially useful when a temporary function is needed. If you have ever used python, you may be familiar with this python code.</p>
<pre><code class="language-python">lambda x: x if x&gt;=0 else -x
</code></pre>
<p>This line of code return the absolute value of input variable x. Since C++11, we can do this.</p>
<pre><code class="language-cpp">[=](double x)-&gt;int{return x&gt;=0? x:-x ;};
</code></pre>
<h3>Lambda Expression - Grammar</h3>
<p>Now let's analyze what does this line of code means.</p>
<p>[=] means that this lambda capture all outside variables by value. <strong>Note that all variables that are captured by value is immutable by default.</strong> All possible values here are:</p>
<ul>
<li><code>[ ]</code>: Do not capture any variable.</li>
<li><code>[=]</code>: Capture all variables by value.</li>
<li><code>[&amp;]</code>: Capture all variables by reference.</li>
<li><code>[=,&amp;y]</code>: Capture <code>y</code> by reference and any other one by value.</li>
<li><code>[&amp;,x]</code>: Capture <code>x</code> by value and any other ones by reference.</li>
<li><code>[&amp;x,y]</code>: Specific how to capture <code>x</code> and <code>y</code>. Other variables are not allowed to be captured.</li>
</ul>
<p><code>(double)</code> is the list of parameters that should be passed to this lambda expression. <strong>In C++14, auto keyword is allowed here, which gives lambda function the ability to perform duck typing.</strong></p>
<p><code>-&gt;int</code> specific that this function return type is <code>int</code>. <strong>Note that this is not voluntary. The function must return an int if declared.</strong> Some other options are also allowed here. All the options including return type can be omitted.</p>
<ul>
<li><code>mutable</code>: Allow modification performed on variables that are captured by value.</li>
<li><code>noexcept</code>: The same how it is used in a normal function.</li>
<li><code>throw()</code>: The same how it is used in a normal function.</li>
<li><code>-&gt;int</code>: Specific return type.</li>
</ul>
<h3>Lambda Expression - Usage</h3>
<p>For lambda expressions, it can be stored in an variable or <code>std::function</code>. Or it can be called instantly or passed directly to a function that accepted it as parameter, <code>std::sort</code> for instance.</p>
<pre><code class="language-cpp">/* Save in an auto variable */
auto lambda1 = [](double x){return x&gt;=0? 1:-1 ;};
/* Construct std::function */
std::function lambda = 
    [](int x) { return x&gt;=0? 1:-1 ; };
/* Directly called */
int i = [](double x){return x&gt;=0? 1:-1 ;}(9);
/* Pass to function as parameter */
std::sort(v.begin(), v.end(), 
    [](auto x, auto y){return x&gt;y;});
</code></pre>
<h2>Lambda expression as a parameter</h2>
<p>Here you have two choices. You may either use <code>std::function</code> or use a template.</p>
<pre><code class="language-cpp">/* std::function solution */
void f_(std::function lambda)
    {/* ... */};
/* Template */
template
void f(F lambda) { /* ... */}
</code></pre>
<h2>Recursive Lambda Expression</h2>
<p>By assigning lambda expression to <code>std::function</code>, it is possible to reference itself. <strong>Note that the function must be captured by reference. Otherwise it will compile but give a run-time error.</strong></p>
<pre><code class="language-cpp">std::function factorial = [=] (int i)
    {
        return (i == 1) ? 1 : i * factorial(i - 1);
    };
</code></pre>
<h2>What is std::function?</h2>
<p>According to <a href="https://en.cppreference.com/w/cpp/utility/functional/">cppreference</a>, instances of <code>std::function</code> can store, copy, and invoke <strong>any CopyConstructible Callable</strong> target. This includes lambda expression, function pointers, and even member functions. Here is an example use <code>std::function</code> instead of traditional function pointer.</p>
<pre><code class="language-cpp">int foo(){return 0;}
/* C style */
int (*fp)(int) = foo;
/* std::function */
std::functionfunc = foo;
</code></pre>
<h2>Create Callback in C++</h2>
<p>If you are familiar with Javascript, you may have known the concept of Callback.</p>
<pre><code class="language-javascript">function Callback() {
    console.log(&quot;I am executed!&quot;);
}
Callback();
</code></pre>
<p>In brief, a Callback is a function that passed to another function as parameter and the function is not executed until the callback is called. Before <code>std::function</code> is introduced, this is achieved through interface and abstract classes, which can sometimes be a dirty solution and cause a lot of chaos. For example, we can create a call back for a class method without using interface.</p>
<pre><code class="language-cpp">class executer{
public:
    int exec(std::function f){
        return f(1);
    }
};

int foo(int a){return a;}

class bar{
public:
    int run(int a){return a;}
};

int main(){
    executer e;
    bar s;
    e.exec(foo);
    using std::placeholders::_1;
    e.exec(std::bind(&amp;bar::run, &amp;s, _1));
}
</code></pre>
<p>In the above example, if callback is not used we can still run <code>foo</code> by passing a function pointer. However, to execute <code>bar::run</code> we will have to inherit <code>executer</code> so that it will accept <code>bar</code> as parameter since non-static member function can not be referenced.</p>
<h2>Usage of std::bind</h2>
<p>The function of <code>std::bind</code> is to bind parameters and the function to create a new functor. It is also able to only bind part of the parameter list and even reorder the parameter by using <code>std::placeholders</code>.</p>
<pre><code class="language-cpp">int foo(int a, int b){return a-b;}

class Bar{
public:
    int run(int a){return a;}
};

int main(){
    /* _1 _2 ... _N is from here */
    using namespace std::placeholders;
    /* foo(b, a) */
    auto f1 = std::bind(foo,_2,_1);
    /* foo(a, 3) */
    auto f2 = std::bind(foo,_1, 3);    
    /* foo(1, 3) */
    auto f3 = std::bind(foo, 1, 3);
    /* return bar.run(a) */
    Bar b;
    auto f4 = std::bind(&amp;Bar::run, &amp;b, _1);
    /* print 1 0 -2 6*/
    printf(&quot;%d %d %d %d&quot;,
           f1(1,2), f2(3,1), f3(-1,-2, 5), f4(6));
}
</code></pre>
<p><code>std::bind</code> accepts both placeholders and real objects. If it binds a placeholder to function, You have to pass the parameter when calling the generated function. Any other parameters are ignored. It is also possible to bind a member function with the actually class object.</p>

        </div>
        <div class="footer-container">
            <div class="footer">
                <div class="quote">
                    <p>
                        永遠太遠 · 無謂太早 · 分對或錯
                    </p>
                </div>
                <div class="footer-inner" id="About">
                    <div class="copyright">
                        Original Photos &amp; Contents
                    </div>
                    <div class="copyright">
                        Copyright ©2021-2023 TerenceNg  All Rights Reserved.
                    </div>
                </div>
                <div class="contact-me">
                    <a href="https://github.com/TerenceNg03">
                        Github Profile
                    </a>
                    |
                    <a href="stoicism03@gmail.com">
                        Contact Me
                    </a>
                </div>
            </div>
        </div>
    </body>
</html>
